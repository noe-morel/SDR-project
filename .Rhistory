library("tidyverse")
library("plotly")
library(shiny)
library(maps)
library(maps)
install.packages(maps)
install.packages("maps")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(plotly)
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("libelle_departement" = "nom_departement"))
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("libelle_departement" = "nom_departement"))
detail_departemental
detail_departemental
detail_departemental <- readr::read_delim("barometre-resultats-detail-departemental.csv", delim = ",", trim_ws = TRUE, show_col_types = FALSE)
detail_regional <- readr::read_delim("barometre-resultats-detail-regional.csv", delim = ",", trim_ws = TRUE, show_col_types = FALSE)
detail_national <- readr::read_delim("barometre-resultats-detail-national.csv", delim = ",", trim_ws = TRUE, show_col_types = FALSE)
synthese_departemental <- readr::read_delim("barometre-resultats-synthese-departemental.csv", delim = ",", trim_ws = TRUE, show_col_types = FALSE)
synthese_regional <- readr::read_delim("barometre-resultats-synthese-regional.csv", delim = ",", trim_ws = TRUE, show_col_types = FALSE)
synthese_national <- readr::read_delim("barometre-resultats-synthese-national.csv", delim = ",", trim_ws = TRUE, show_col_types = FALSE)
reg_dep <- readr::read_delim("departements-france.csv", delim = ",", trim_ws = TRUE, show_col_types = FALSE)
mapdata <- map_data("france")
mapdata$region <- tolower(gsub(' ','-',mapdata$region))
synthese_departemental$libelle_departement <- iconv(synthese_departemental$libelle_departement,to="ASCII//TRANSLIT")
synthese_departemental$libelle_departement <- gsub("'","",synthese_departemental$libelle_departement)
synthese_departemental$libelle_departement <- tolower(synthese_departemental$libelle_departement)
synthese_departemental$libelle_departement <- tolower(gsub(' ','-',synthese_departemental$libelle_departement))
detail_departemental$libelle_departement <- iconv(detail_departemental$libelle_departement,to="ASCII//TRANSLIT")
detail_departemental$libelle_departement <- gsub("'","",detail_departemental$libelle_departement)
detail_departemental$libelle_departement <- tolower(detail_departemental$libelle_departement)
detail_departemental$libelle_departement <- tolower(gsub(' ','-',detail_departemental$libelle_departement))
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("libelle_departement" = "nom_departement"))
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11") |>
mutate(valeur_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=month(date), y=valeur_mois)) +
facet_grid(vars(year), vars(nom_departement))
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("libelle_departement" = "nom_departement"))|>
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11") |>
mutate(valeur_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=month(date), y=valeur_mois)) +
facet_grid(vars(year), vars(nom_departement))
plotly::ggplotly(UnJeuneDepIdF)
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("libelle_departement" = "nom_departement"))|>
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11") |>
mutate(valeur_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=month(date), y=valeur_mois))
plotly::ggplotly(UnJeuneDepIdF)
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("libelle_departement" = "nom_departement"))
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("libelle_departement" = "nom_departement"))
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = code_departement)
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = "code_departement")
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = code_departement)
detail_departemental[code_departement]
detail_departemental[code_departement]
detail_departemental["code_departement"]
left_join(reg_dep, by = c("code_departement"="code_departement")
left_join(reg_dep, by = c("code_departement"="code_departement")
left_join(reg_dep, by = c("code_departement"="code_departement")
UnJeuneDepIdF
UnJeuneDepIdF
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11")
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11")
UnJeuneDepIdF
filter("mesure"=="Plan 1 jeune 1 solution" & code_region=="11")
filter("mesure"=="Plan 1 jeune 1 solution" & "code_region"=="11")
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11")
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("code_departement"="code_departement"))|>
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11")
UnJeuneDepIdF
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("code_departement"="code_departement"))|>
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11")|>
mutate(valeur_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=month(date), y=valeur_mois))
UnJeuneDepIdF
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("code_departement"="code_departement"))|>
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11")|>
mutate(valeur_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=date, y=valeur_mois))
plotly::ggplotly(UnJeuneDepIdF)
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("code_departement"="code_departement"))|>
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11")|>
mutate(valeur_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=date, y=valeur_mois))+
facet_grid(vars(year), vars(nom_departement))
plotly::ggplotly(UnJeuneDepIdF)
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("code_departement"="code_departement"))|>
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11")|>
mutate(valeur_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=date, y=valeur_mois))+
facet_grid(vars(year), vars(nom_departement), scale="free")
plotly::ggplotly(UnJeuneDepIdF)
?facet_grid
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("code_departement"="code_departement"))|>
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11")|>
mutate(valeur_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=date, y=valeur_mois))+
facet_grid(vars(year), vars(nom_departement), scales="free")
plotly::ggplotly(UnJeuneDepIdF)
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("code_departement"="code_departement"))|>
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11")|>
mutate(valeur_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=month(date), y=valeur_mois))+
facet_grid(vars(year), vars(nom_departement), scales="free")
plotly::ggplotly(UnJeuneDepIdF)
UnJeuneNational <- detail_national |>
filter(mesure=="Plan 1 jeune 1 solution") |>
mutate(recrutés_par_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
rename(recrutés_cumulés = valeur) |>
pivot_longer(c(recrutés_cumulés, recrutés_par_mois), names_to = "type", values_to = "valeur") |>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=date, y=valeur, fg=type)) +
labs(title = "Jeunes recrutés grâce au projet",
x = "Date",
y = "Nombre de recrutement")
plotly::ggplotly(UnJeuneNational)
UnJeuneNational <- detail_regional |>
filter(mesure=="Plan 1 jeune 1 solution" & month(date)==7) |>
mutate(year = year(date)) |>
ggplot() +
geom_col(mapping = aes(x=libelle_region, y=valeur, bg=libelle_region))+
theme(axis.text.x=element_blank(),axis.ticks.x=element_blank(),axis.title.x=element_blank())+
facet_wrap(vars(year), nrow=1)+
labs(title = "Jeunes recrutés grâce au projet par région",
x = "Date",
y = "Nombre de recrutement",
bg="Région")
plotly::ggplotly(UnJeuneNational)
UnJeuneIdF <- detail_regional |>
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11") |>
mutate(valeur_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=month(date), y=valeur_mois)) +
facet_wrap(vars(year), nrow=1)+
labs(title = "Jeunes recrutés grâce au projet en Île de France",
x = "Date",
y = "Nombre de recrutement")
plotly::ggplotly(UnJeuneIdF)
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("code_departement"="code_departement"))|>
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11")|>
mutate(valeur_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=month(date), y=valeur_mois))+
facet_grid(vars(nom_departement), vars(year), scales="free")
plotly::ggplotly(UnJeuneDepIdF)
UnJeuneDepIdF <- detail_departemental |>
left_join(reg_dep, by = c("code_departement"="code_departement"))|>
filter(mesure=="Plan 1 jeune 1 solution" & code_region=="11")|>
mutate(valeur_mois = if_else(valeur>lag(valeur), valeur-lag(valeur), valeur, missing=valeur))|>
mutate(year = year(date)) |>
ggplot() +
geom_point(mapping=aes(x=month(date), y=valeur_mois))+
facet_grid(vars(nom_departement), vars(year), scales="fixed")
plotly::ggplotly(UnJeuneDepIdF)
